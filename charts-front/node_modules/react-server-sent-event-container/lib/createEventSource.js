'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function (eventSourceUrl) {
    var withCredentials = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
    var eventSourceProps = arguments[2];
    var onOpen = arguments[3];
    var onMessage = arguments[4];
    var onError = arguments[5];
    var eventObj = arguments[6];

    if (!eventSourceUrl) {
        throw new Error('eventSourceUrl is required');
    }

    if (!eventSourceProps) {
        throw new Error('eventSourceProps is required');
    }

    var eventSource = new EventSource(eventSourceUrl, { withCredentials: withCredentials });

    if (onOpen) {
        eventSource.onopen = function () {
            onOpen(eventSourceProps, eventSource);
        };
    }

    if (onMessage) {
        eventSource.onmessage = function (event) {
            onMessage(event, eventSourceProps, eventSource);
        };
    }

    if (onError) {
        eventSource.onerror = function (event) {
            onError(event, eventSourceProps, eventSource);
        };
    }

    if (eventObj) {
        var keys = Object.keys(eventObj);

        var _loop = function _loop() {
            var fn = eventObj[keys[i]];
            if (typeof fn === 'function') {
                eventSource.addEventListener(keys[i], function (event) {
                    fn(event, eventSourceProps, eventSource);
                });
            }
        };

        for (var i = 0; i < keys.length; i++) {
            _loop();
        }
    }

    return eventSource;
};